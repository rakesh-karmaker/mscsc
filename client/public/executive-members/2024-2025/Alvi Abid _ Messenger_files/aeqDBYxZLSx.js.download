;/*FB_PKG_DELIM*/

__d("LSTriggerOnDemandCutoverIfNeeded",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("open_thread_id",a[0]),d[1]=d[0].get("open_thread_id"),d[2]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[1]),c.i64.cast([0,741]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxTriggerOnDemandCutoverIfNeededStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSTriggerOnDemandCutoverIfNeededStoredProcedure",["LSSynchronousPromise","LSTriggerOnDemandCutoverIfNeeded","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSTriggerOnDemandCutoverIfNeeded"),e.waJid);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MAWOnDemandCutoverQPLLogger",["I64","MAWLoggerUtils","QPLUserFlow","WALoggerDeferred","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[OD-Cutover] Cutover (non-blocking) cancelled for ThreadKey: ",". ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[OD-Cutover] Cutover (non-blocking) finished with error for ThreadKey: ",". ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[OD-Cutover] Cutover (non-blocking) finished successfully for ThreadKey: ",". ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[OD-Cutover] Secure thread created for od-cutover (non-blocking) for ThreadKey: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[OD-Cutover] Triggering cutover (non-blocking) from "," for ThreadKey: ",""]);m=function(){return a};return a}var n=new Set();function a(a,b){var e=d("MAWLoggerUtils").getInstanceKeyFromId((h||(h=d("I64"))).to_string(a));n.has(e)?o(a,"already_in_progress"):(c("promiseDone")(d("WALoggerDeferred").LOG(m(),b,(h||(h=d("I64"))).to_string(a))),n.add(e),c("QPLUserFlow").start(c("qpl")._(1056847893,"505"),{annotations:{bool:{is_non_blocking:!0},string:{entrypoint:b}},instanceKey:e}))}function o(a,b,e){var f=d("MAWLoggerUtils").getInstanceKeyFromId((h||(h=d("I64"))).to_string(a));b==="secure_thread_created"&&c("promiseDone")(d("WALoggerDeferred").LOG(l(),(h||(h=d("I64"))).to_string(a)));c("QPLUserFlow").addPoint(c("qpl")._(1056847893,"505"),b,babelHelpers["extends"]({instanceKey:f},e))}function b(a,b){a=d("MAWLoggerUtils").getInstanceKeyFromId((h||(h=d("I64"))).to_string(a));c("QPLUserFlow").addAnnotations(c("qpl")._(1056847893,"505"),b,{instanceKey:a})}function e(a,b){var e=d("MAWLoggerUtils").getInstanceKeyFromId((h||(h=d("I64"))).to_string(a));n.has(e)&&(c("promiseDone")(d("WALoggerDeferred").LOG(k(),(h||(h=d("I64"))).to_string(a),b!=null?b:"")),c("QPLUserFlow").endSuccess(c("qpl")._(1056847893,"505"),babelHelpers["extends"]({},b!==null&&{annotations:{string:{message:b}}},{instanceKey:e})),n["delete"](e))}function f(a,b){var e=d("MAWLoggerUtils").getInstanceKeyFromId((h||(h=d("I64"))).to_string(a));n.has(e)&&(c("promiseDone")(d("WALoggerDeferred").LOG(j(),(h||(h=d("I64"))).to_string(a),b!=null?b:"")),c("QPLUserFlow").endFailure(c("qpl")._(1056847893,"505"),b,{instanceKey:e}),n["delete"](e))}function p(a,b){var e=d("MAWLoggerUtils").getInstanceKeyFromId((h||(h=d("I64"))).to_string(a));n.has(e)&&(c("promiseDone")(d("WALoggerDeferred").LOG(i(),(h||(h=d("I64"))).to_string(a),b!=null?b:"")),c("QPLUserFlow").endCancel(c("qpl")._(1056847893,"505"),babelHelpers["extends"]({},b!==null&&{annotations:{string:{reason:b}}},{instanceKey:e})),n["delete"](e))}g.startQpl=a;g.addPoint=o;g.addAnnotations=b;g.endSuccessIfInProgress=e;g.endFailureIfInProgress=f;g.endCancelIfInProgress=p}),98);
__d("MAWOnDemandCutoverTrigger",["LSCutoverMappingQueryFromOpenThreadIdStoredProcedure","LSFactory","LSTriggerOnDemandCutoverIfNeededStoredProcedure","MAWCreateAndWaitForAuthoritativeOneToOneThread","MAWOnDemandCutoverQPLLogger","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,e){d("MAWOnDemandCutoverQPLLogger").startQpl(b,e),c("promiseDone")(a.runInTransaction(function(a){return c("LSCutoverMappingQueryFromOpenThreadIdStoredProcedure")(c("LSFactory")(a),{openThreadId:b})},"readwrite",void 0,void 0,f.id+":35")),c("promiseDone")(a.runInTransaction(function(a){return c("LSTriggerOnDemandCutoverIfNeededStoredProcedure")(c("LSFactory")(a),{waJid:b})},"readwrite",void 0,void 0,f.id+":45"))}function a(a,b,e){h(a,b,e),c("MAWCreateAndWaitForAuthoritativeOneToOneThread")(a,b,"MAWOnDemandCutoverTrigger",function(){d("MAWOnDemandCutoverQPLLogger").addPoint(b,"secure_thread_created")})}g.triggerOnDemandCutover=h;g.triggerOnDemandCutoverAndCreateSecureThread=a}),98);
__d("WAGetUserMedia",[],(function(a,b,c,d,e,f){"use strict";function a(){var a=navigator.mediaDevices;return a==null?null:function(b){return a.getUserMedia(b)}}b=a();f.getUserMedia=b}),66);
__d("WAOpusRecorderWorkerClient",["WAWebOpusRecorderWorkerResource","WorkerBundleResource"],(function(a,b,c,d,e,f,g){var h=function(){function a(a){this.$1=d("WorkerBundleResource").createDedicatedWebWorker(c("WAWebOpusRecorderWorkerResource"));this.$1.onmessage=(a=a)!=null?a:null}var b=a.prototype;b.getWorker=function(){return this.$1};b.postMessage=function(a,b){a={type:"message",message:a};this.$1.postMessage(a,b)};b.addEventListener=function(a,b){this.$1.addEventListener(a,b)};b.removeEventListener=function(a,b){this.$1.addEventListener(a,b)};return a}();function a(){return new h()}function b(a){return new h(a)}g.WAOpusRecorderWorkerClient=h;g.getOpusEncoderWorker=a;g.getOpusDecoderWorker=b}),98);
__d("WAPttComposerOpusRecorder",["$InternalEnum","Promise","WAGetUserMedia","WANullthrows","WAOpusRecorderWorkerClient","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i={bitRate:16e3,bufferLength:4096,numberOfChannels:1,encoderSampleRate:16e3,maxBuffersPerPage:40,encoderApplication:2048,encoderFrameSize:20,streamOptions:{optional:[],mandatory:{googEchoCancellation:!1,googAutoGainControl:!1,googNoiseSuppression:!1,googHighpassFilter:!1}}},j=b("$InternalEnum").Mirrored(["INACTIVE","RECORDING","PAUSED","STOPPED"]);a=function(){function a(a){var d=this;this._duration=0;this._recordedPages=[];this._state=j.INACTIVE;this._isFirstBuffer=!1;this._requestCount=0;this._pendingFlushResolvers=new Map();this._handleEncoderMessage=function(a){a=a.data;switch(a.message){case"page":d._storePage(a.page);break;case"flushed":d._handleFlushed(a.requestId);break;default:throw c("err")("Invalid message event type: "+a.message)}};if(!l())throw c("err")("Recording is not supported in this browser");this._createStream=a.createStream;this._onDuration=a.onDuration;this._onPause=a.onPause;this._onResume=a.onResume;this._onStart=a.onStart;this._onStop=a.onStop;this._handlePage=a.onPage;this._completeRecordingPromise=new(h||(h=b("Promise")))(function(a){d._resolveCompleteRecordingPromise=a});this._audioContext=new AudioContext();this._encoderNode=this._audioContext.createScriptProcessor(i.bufferLength,i.numberOfChannels,i.numberOfChannels);this._encoderNode.onaudioprocess=function(a){d._encodeBuffers(a.inputBuffer)};this._monitorNode=this._audioContext.createGain()}var e=a.prototype;e.getState=function(){return this._state};e.start=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){switch(this._state){case j.RECORDING:return!0;case j.STOPPED:return!1;case j.PAUSED:return this.resume();case j.INACTIVE:break}this._recordedPages=[];this._isFirstBuffer=!0;this._duration=0;var a=d("WAOpusRecorderWorkerClient").getOpusEncoderWorker();this._encoder=a;a.addEventListener("message",this._handleEncoderMessage);var b=(yield this._startRecording());if(!b)return!1;this._onStart==null?void 0:this._onStart();this._onDuration==null?void 0:this._onDuration(this._duration);a.postMessage({command:"encode-init",config:babelHelpers["extends"]({},i,{originalSampleRate:this._audioContext.sampleRate})});this._encoderNode.connect(this._audioContext.destination);return!0});function c(){return a.apply(this,arguments)}return c}();e.stop=function(){var a;if(this._state===j.STOPPED)return;this._state=j.STOPPED;(a=this._recordingAbortController)==null?void 0:a.abort();this._audioContext.close&&this._audioContext.close();this._monitorNode.disconnect();this._encoderNode.disconnect();(a=this._encoder)==null?void 0:a.postMessage({command:"encode-done"})};e.pause=function(){var a;if(this._state!==j.RECORDING)return;this._state=j.PAUSED;(a=this._recordingAbortController)==null?void 0:a.abort();this._onPause==null?void 0:this._onPause()};e.resume=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){switch(this._state){case j.RECORDING:return!0;case j.STOPPED:return!1;case j.INACTIVE:throw c("err")("Attempting to resume recording that hasn't started");case j.PAUSED:break}var a=(yield this._startRecording());if(!a)return!1;this._onResume==null?void 0:this._onResume();return!0});function d(){return a.apply(this,arguments)}return d}();e.getDuration=function(){return this._duration};e.getMonitorNode=function(){return this._monitorNode};e._encodeBuffers=function(a){if(this._isFirstBuffer){this._isFirstBuffer=!1;return}if(this._state!==j.RECORDING)return;var b=[];for(var d=0;d<a.numberOfChannels;d++)b[d]=a.getChannelData(d);d=c("WANullthrows")(this._encoder);d.postMessage({command:"encode",buffers:b});this._duration+=a.duration;this._onDuration==null?void 0:this._onDuration(this._duration)};e._getNextRequestId=function(){this._requestCount++;return this._requestCount};e._startRecording=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){this._state=j.RECORDING;this._recordingAbortController=new AbortController();var a=(yield m(this._createStream,this._audioContext,[this._encoderNode,this._monitorNode],this._recordingAbortController.signal));if(!a){this.stop();return!1}return!0});function a(){return a.apply(this,arguments)}return a}();e._storePage=function(a){this._recordedPages.push(a);if(a[5]&4){this._handlePage==null?void 0:this._handlePage(a,!0);var b=c("WANullthrows")(this._encoder);b.removeEventListener("message",this._handleEncoderMessage);this._resolveCompleteRecordingPromise(k(this._recordedPages));this._recordedPages=[];this._onStop==null?void 0:this._onStop();return}this._handlePage==null?void 0:this._handlePage(a,!1)};e._handleFlushed=function(a){var b=c("WANullthrows")(this._pendingFlushResolvers.get(a));this._pendingFlushResolvers["delete"](a);b(k(this._recordedPages))};e.getPartialRecording=function(){var a=this,d=this._getNextRequestId(),e=new(h||(h=b("Promise")))(function(b){a._pendingFlushResolvers.set(d,b)}),f=c("WANullthrows")(this._encoder);f.postMessage({command:"flush",requestId:d});return e};e.getCompleteRecording=function(){return this._completeRecordingPromise};return a}();function k(a){var b=a.reduce(function(a,b){return a+b.length},0);b=new Uint8Array(b);var c=0;for(a of a)b.set(a,c),c+=a.length;return new Blob([b],{type:"audio/ogg; codecs=opus"})}function l(){return Boolean(window.AudioContext&&d("WAGetUserMedia").getUserMedia)}function m(a,b,c,d){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d){var e=(yield a(d));if(d.aborted||e==null)return!1;var f=b.createMediaStreamSource(e);c.forEach(function(a){f.connect(a)});d.addEventListener("abort",function(){e.getTracks().forEach(function(a){a.stop()}),f.disconnect()},{once:!0});return!0});return n.apply(this,arguments)}g.OpusRecorderState=j;g.OpusRecorder=a}),98);
__d("WAPttComposerRecorderPollableTimer",[],(function(a,b,c,d,e,f){a=function(){function a(){}var b=a.prototype;b.start=function(){this.$1=Date.now()};b.stop=function(){this.$2=Date.now()};b.pause=function(){this.stop()};b.resume=function(){this.$1=Date.now()-this.getTime(),this.$2=null};b.getTime=function(){var a,b=this.$1;if(b==null)return 0;a=(a=this.$2)!=null?a:Date.now();return a-b};return a}();f["default"]=a}),66);
__d("WAPttComposerScaleWaveform",["invariant"],(function(a,b,c,d,e,f,g,h){function a(a,b){if(b===a.length)return a;if(b===0)return[];if(a.length===0)return new Array(b).fill(0);return b>a.length?i(a,b):j(a,b)}function i(a,b){b>a.length||h(0,75746,b,a.length);var c;if(a.length===1)c=0;else{var d=(b-a.length)/(a.length-1);c=1/(1+d)}d=[];b>=1&&d.push(a[0]);for(var e=1;e<b-1;e++){var f=e*c,g=Math.floor(f),i=f-g;d.push(k(a[g],a[Math.ceil(f)],i))}b>=2&&d.push(a[a.length-1]);return d}function j(a,b){b<a.length||h(0,75747,b,a.length);var c=[];b=b/a.length;var d=0,e=0,f=0;for(var a=a,g=Array.isArray(a),i=0,a=g?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(g){if(i>=a.length)break;j=a[i++]}else{i=a.next();if(i.done)break;j=i.value}j=j;d+=j;f+=1;e+=b;e>=1&&(c.push(d/f),f=0,d=0,e-=1)}f>0&&c.push(d/f);return c}function k(a,b,c){return a+(b-a)*c}g["default"]=a}),98);
__d("WAStartAnimationLoop",[],(function(a,b,c,d,e,f){function a(a,b){b=(b=b)!=null?b:{};b=b.delay;var c=b===void 0?0:b,d,e,f;b=function(){e=!0,window.cancelAnimationFrame(d)};var g=function b(g){(f==null||g-f>=c)&&(a(g),f=g);if(e)return;d=window.requestAnimationFrame(b)};d=window.requestAnimationFrame(g);return b}f.startAnimationLoop=a}),66);
__d("WAPttComposerWaveformRecorder",["WANullthrows","WAPttComposerRecorderPollableTimer","WAPttComposerScaleWaveform","WAStartAnimationLoop"],(function(a,b,c,d,e,f,g){a=function(){function a(a,b){var d=this;this.$2=new(c("WAPttComposerRecorderPollableTimer"))();this.$3=[];this.$4=[];this.$5=0;this.$10=function(){d.$5=Math.max(d.$5,d.$11());var a=d.$3.length/d.$1;a=Math.floor((d.getDuration()-a)*d.$1);if(a===0)return;for(var b=0;b<a;b++)d.$3.push(d.$5);d.$5=0};this.$12=0;this.$7=h(a);a.connect(this.$7);this.$1=b}var b=a.prototype;b.start=function(){this.$2.start(),this.$9()};b.stop=function(){this.$2.stop(),this.$6==null?void 0:this.$6()};b.pause=function(){this.$2.pause(),this.$6==null?void 0:this.$6()};b.resume=function(){this.$2.resume(),this.$9()};b.$9=function(){this.$6=d("WAStartAnimationLoop").startAnimationLoop(this.$10)};b.$11=function(){var a,b=c("WANullthrows")(this.$7);this.$8=(a=this.$8)!=null?a:new Uint8Array(b.frequencyBinCount);a=this.$8;b.getByteFrequencyData(a);return Math.max.apply(Math,Array.from(a))/255};b.commitSamples=function(a){a=Math.floor(a*this.$1);a=a-this.$4.length;var b=this.$3.length-this.$12;if(a===0||b===0)return;b=this.$3.slice(this.$12,this.$3.length);b=c("WAPttComposerScaleWaveform")(b,a);for(var a=b,b=Array.isArray(a),d=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(b){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;this.$4.push(e)}this.$12=this.$3.length};b.getSamples=function(){return this.$3};b.getDuration=function(){var a;a=(a=this.$2.getTime())!=null?a:0;return a/1e3};b.getCorrectedSamples=function(){return this.$4};return a}();function h(a){a=a.context.createAnalyser();a.fftSize=32;a.smoothingTimeConstant=0;a.minDecibels=-60;a.maxDecibels=-10;return a}g["default"]=a}),98);
__d("WAPttComposerRecorder",["WAPttComposerOpusRecorder","WAPttComposerWaveformRecorder","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a=function(){function a(a){var b=this;this._handleOpusRecorderDuration=function(){b._waveformRecorder.commitSamples(b.getDuration()),b._onDuration==null?void 0:b._onDuration(b.getDuration())};this._onDuration=a.onDuration;this._opusRecorder=new(d("WAPttComposerOpusRecorder").OpusRecorder)({createStream:a.createStream,onDuration:this._handleOpusRecorderDuration,onPage:function(b,c){a.onPage==null?void 0:a.onPage(b,c)}});this._waveformRecorder=new(c("WAPttComposerWaveformRecorder"))(this._opusRecorder.getMonitorNode(),a.waveformSampleRate)}var e=a.prototype;e.start=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield this._opusRecorder.start());if(!a)return!1;this._waveformRecorder.start();return!0});function c(){return a.apply(this,arguments)}return c}();e.stop=function(){this._opusRecorder.stop(),this._waveformRecorder.stop()};e.pause=function(){this._opusRecorder.pause(),this._waveformRecorder.pause()};e.resume=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield this._opusRecorder.resume());if(!a)return!1;this._waveformRecorder.resume();return!0});function c(){return a.apply(this,arguments)}return c}();e.getDuration=function(){return this._opusRecorder.getDuration()};e.getPreciseDuration=function(){var a;return(a=this._waveformRecorder.getDuration())!=null?a:0};e.getLiveWaveformSamples=function(){return this._waveformRecorder.getSamples()};e.getCorrectedWaveformSamples=function(){return this._waveformRecorder.getCorrectedSamples()};e.getPartialRecording=function(){return this._opusRecorder.getPartialRecording()};e.getCompleteRecording=function(){return this._opusRecorder.getCompleteRecording()};return a}();g["default"]=a}),98);
__d("MWPUseVoiceRecorderV2",["MWPAudioPlayerIcons.react","MWPAudioPlayerLabels","Promise","WAPttComposerRecorder","WATagsLogger","clearTimeout","emptyFunction","err","react","setTimeout","useIsMountedRef","usePrevious"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["PTT recording stop Error ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["PTT recording start Error ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["PTT recording start successfully"]);l=function(){return a};return a}var m=i||(i=d("react")),n=i,o=n.useCallback,p=n.useEffect,q=n.useReducer,r=n.useRef,s=d("WATagsLogger").TAGS(["MWPUseVoiceRecorderV2"]),t=8.5;function a(a){switch(a.stage){case"Unopen":case"Recording":return!1;case"Recorded":case"Playing":return!0}}function e(a){switch(a.stage){case"Unopen":case"Recording":return!1;case"Recorded":case"Playing":return!0}}function u(a){switch(a.stage){case"Unopen":return 0;case"Recording":return a.duration;case"Recorded":case"Playing":return Math.max(a.duration-a.currentTime,0)}}function v(a){switch(a.stage){case"Unopen":return 0;case"Recording":return a.recordingTimeout;case"Recorded":case"Playing":return a.duration}}function w(a){switch(a.stage){case"Unopen":case"Recording":return;case"Recorded":case"Playing":return a.currentTime}}function x(a){switch(a.stage){case"Unopen":case"Recorded":return!1;case"Recording":case"Playing":return!0}}function y(a){if(a.stage==="Recorded")return a.currentTime===0;else return!1}function z(a){switch(a.stage){case"Recording":return d("MWPAudioPlayerLabels").stopLabel;case"Unopen":case"Recorded":return d("MWPAudioPlayerLabels").playLabel;case"Playing":return d("MWPAudioPlayerLabels").pauseLabel}}function A(a,b){switch(a.stage){case"Recording":return m.jsx(d("MWPAudioPlayerIcons.react").StopIcon,{color:b});case"Unopen":case"Recorded":return m.jsx(d("MWPAudioPlayerIcons.react").PlayIcon,{color:b});case"Playing":return m.jsx(d("MWPAudioPlayerIcons.react").PauseIcon,{color:b})}}A.displayName=A.name+" [from "+f.id+"]";function B(a,b){switch(b.type){case"Start":return{duration:0,mediaStream:b.mediaStream,recordingTimeout:b.recordingTimeout,stage:"Recording"};case"Toggle":switch(a.stage){case"Unopen":return a;case"Recording":return{currentTime:0,duration:a.duration,stage:"Recorded"};case"Recorded":return{currentTime:a.currentTime,duration:a.duration,stage:"Playing"};case"Playing":return{currentTime:a.currentTime,duration:a.duration,stage:"Recorded"}}break;case"UpdateDuration":if(a.duration!=null&&b.duration<a.duration)return a;var c=b.duration;switch(a.stage){case"Unopen":return a;case"Recording":return{duration:c,mediaStream:a.mediaStream,recordingTimeout:a.recordingTimeout,stage:"Recording"};case"Recorded":return{currentTime:a.currentTime,duration:c,stage:"Recorded"};case"Playing":return{currentTime:a.currentTime,duration:c,stage:"Playing"}}break;case"UpdateTime":c=b.currentTime;switch(a.stage){case"Unopen":case"Recording":return a;case"Recorded":var d=a.duration;return c===d?{currentTime:0,duration:d,stage:"Recorded"}:{currentTime:c,duration:d,stage:"Recorded"};case"Playing":d=a.duration;return c===d?{currentTime:0,duration:d,stage:"Recorded"}:{currentTime:c,duration:d,stage:"Playing"}}break;case"RecordingTimeout":return{currentTime:0,duration:b.recordingTimeout,stage:"Recorded"};case"Reset":return{stage:"Unopen"}}}var C={stage:"Unopen"};function D(a,d,e){a===void 0&&(a=60);d===void 0&&(d=c("emptyFunction"));e===void 0&&(e=c("emptyFunction"));var f=q(B,C),g=f[0],i=f[1],m=c("useIsMountedRef")(),n=r(),u=r(),v=r(),w=r(),x=r(c("emptyFunction")),y=o(function(a){var b=a[0],c=a[1];if(!m.current)return;var d=new File([b],"voice-clip.ogg",{type:"audio/ogg"});a=URL.createObjectURL(d);v.current=a;var e=new Audio(a);e.addEventListener("canplay",function(){u.current=e;var a=e.duration;i({duration:a,type:"UpdateDuration"});var b={amplitudes:c,sampling_freq:t};a={duration:a,file:d,waveformData:b};w.current=a;x.current(a)});e.addEventListener("timeupdate",function(){var a;a=(a=u.current)==null?void 0:a.currentTime;a!=null&&i({currentTime:a,type:"UpdateTime"})});e.addEventListener("durationchange",function(){var a;a=(a=u.current)==null?void 0:a.duration;a!=null&&!Number.isNaN(a)&&i({duration:a,type:"UpdateDuration"})})},[m]);p(function(){if(g.stage!=="Recording")return;d();var a=g.mediaStream;void (h||(h=b("Promise"))).resolve().then(function(){var d=new(c("WAPttComposerRecorder"))({createStream:function(){return(h||(h=b("Promise"))).resolve(a)},waveformSampleRate:t});n.current=d;return d.start()}).then(function(a){if(a){s.LOG(l());return}return(h||(h=b("Promise"))).reject(c("err")("PTT recording start failed"))})["catch"](function(a){s.ERROR(k(),a)});return function(){var a;(a=n.current)==null?void 0:a.stop()}},[d,g.mediaStream,g.stage]);var z=c("usePrevious")(g);p(function(){if((z==null?void 0:z.stage)==="Recording"&&g.stage==="Recorded"){var a=n.current;if(a==null)return;a.stop();void (h||(h=b("Promise"))).all([a.getCompleteRecording(),a.getCorrectedWaveformSamples()]).then(function(a){var b=a[0];a=a[1];y([b,a])})["catch"](function(a){s.ERROR(j(),a)})}},[y,z==null?void 0:z.stage,g.stage]);p(function(){if(g.stage!=="Recording")return;var b=Date.now(),d,e=function e(){var f=(Date.now()-b)/1e3;if(f>=a){i({recordingTimeout:a,type:"RecordingTimeout"});return}i({duration:f,type:"UpdateDuration"});d=c("setTimeout")(e,1e3)};d=c("setTimeout")(e,1e3);return function(){d!=null&&c("clearTimeout")(d)}},[a,g.stage]);f=o(function(b){i({mediaStream:b,recordingTimeout:a,type:"Start"})},[a]);var A=o(function(){var a;i({type:"Reset"});(a=u.current)==null?void 0:a.pause();u.current=void 0;w.current=void 0;a=v.current;a!=null&&(URL.revokeObjectURL(a),v.current=void 0)},[]),D=o(function(){var a=function(){i({type:"Toggle"})},b=u.current;if(b==null){a();return}switch(g.stage){case"Unopen":case"Recording":a();break;case"Recorded":b.play().then(a)["catch"](e);break;case"Playing":b.pause();a();break}},[e,g.stage]),E=o(function(){return new(h||(h=b("Promise")))(function(a){var b=w.current;if(b!=null)return a(b);x.current=a;if(g.stage==="Recording")return D()})},[g,D]);return{audioEl:u,getVoiceClip:E,reset:A,start:f,state:g,toggle:D}}g.showScreenReaderLabel=a;g.hasScrubber=e;g.getTimerTime=u;g.getDuration=v;g.getCurrentTime=w;g.isProgressing=x;g.isCompleted=y;g.getPlaybackLabel=z;g.getPlaybackIcon=A;g.useVoiceRecorder=D}),98);
__d("MWV2ChatTabThreadLinkHashContext.react",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));c=h;e=c.createContext;var j=c.useContext,k=e(null);function a(a){var b=d("react-compiler-runtime").c(3),c=a.children;a=a.threadLinkHash;a=(a=a)!=null?a:null;var e;b[0]!==c||b[1]!==a?(e=i.jsx(k.Provider,{value:a,children:c}),b[0]=c,b[1]=a,b[2]=e):e=b[2];return e}function b(){return j(k)}g.MWV2ChatTabThreadLinkHashContextProvider=a;g.useGetChatTabThreadLinkHash=b}),98);
__d("useMAWMaybeTriggerODCutoverForSecureThread",["I64","Int64Hooks","LSMessagingThreadTypeUtil","MAWOnDemandCutoverTrigger","ReQL","ReQLSuspense","gkx","react-compiler-runtime","useMAWCanThreadBeCutoverOnDemandV2","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){var b=d("react-compiler-runtime").c(10),e=a.threadKey,g=a.threadType,k=a.triggerSource,l=(i||(i=c("useReStore")))();b[0]!==l.tables._user_info?(a=function(){return d("ReQL").fromTableAscending(l.tables._user_info).map(j)},b[0]=l.tables._user_info,b[1]=a):a=b[1];var m;b[2]!==l?(m=[l],b[2]=l,b[3]=m):m=b[3];var n=d("ReQLSuspense").useFirst(a,m,f.id+":39"),o=(a=d("ReQLSuspense").useFirst(function(){return e!=null&&g!=null&&n!=null&&d("LSMessagingThreadTypeUtil").isArmadilloSecureOneToOne(g)?d("ReQL").fromTableAscending(l.tables.participants,["contactId"]).getKeyRange(e).filter(function(a){return!(h||(h=d("I64"))).equal(a.contactId,n)}):d("ReQL").empty()},[l,e,g,n],f.id+":44"))==null?void 0:a.contactId,p=c("useMAWCanThreadBeCutoverOnDemandV2")(o);b[4]!==p||b[5]!==l||b[6]!==o||b[7]!==k?(m=function(){o!=null&&p&&c("gkx")("7867")&&d("MAWOnDemandCutoverTrigger").triggerOnDemandCutover(l,o,k)},a=[p,l,o,k],b[4]=p,b[5]=l,b[6]=o,b[7]=k,b[8]=m,b[9]=a):(m=b[8],a=b[9]);d("Int64Hooks").useEffectInt64(m,a)}function j(a){return a.facebookUserId}g["default"]=a}),98);